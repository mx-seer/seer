import{f,a as v,t as W,c as ma}from"../chunks/BVX7dXtv.js";import{o as ba}from"../chunks/DowC_kZ7.js";import{p as ga,s as x,a as ya,f as X,b as l,c as ha,d as r,e as o,r as s,g as a,t as N}from"../chunks/ClognnWn.js";import{d as xa,s as F}from"../chunks/Dyg_a2vo.js";import{i as b}from"../chunks/CCjHch1u.js";import{c as Sa,d as wa,e as Z,i as $,r as J,f as ka,h as Aa,j as ja,t as Fa,k as Ra}from"../chunks/DjcNkSeP.js";import{b as Ta,a as aa}from"../chunks/DpRXFKjw.js";var Ca=f('<div class="alert alert-info"><span><!></span></div>'),Ma=f('<div class="flex justify-center p-8"><span class="loading loading-spinner loading-lg"></span></div>'),Pa=f('<div class="badge badge-primary badge-sm ml-1">Built-in</div>'),Da=f('<p class="text-sm text-base-content/60 truncate"> </p>'),Ea=f('<button class="btn btn-error btn-sm">Delete</button>'),Na=f('<div class="card bg-base-100 shadow-xl"><div class="card-body"><div class="flex justify-between items-start"><div><h2 class="card-title"> </h2> <div class="badge badge-outline"> </div> <!></div> <input type="checkbox" class="toggle toggle-primary"/></div> <!> <div class="card-actions justify-end mt-4"><!></div></div></div>'),Ua=f('<div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3"></div>'),La=f('<div class="alert alert-error mt-4"><span> </span></div>'),qa=f("<option> </option>"),Ba=f('<div class="form-control mt-4"><label class="label" for="source-url"><span class="label-text">URL</span></label> <input id="source-url" type="url" class="input input-bordered" placeholder="https://example.com/feed.xml"/></div>'),Ya=f('<div class="modal modal-open"><div class="modal-box"><h3 class="font-bold text-lg">Add New Source</h3> <!> <div class="form-control mt-4"><label class="label" for="source-type"><span class="label-text">Type</span></label> <select id="source-type" class="select select-bordered"><option>Select type...</option><!></select></div> <div class="form-control mt-4"><label class="label" for="source-name"><span class="label-text">Name</span></label> <input id="source-name" type="text" class="input input-bordered" placeholder="My Custom Source"/></div> <!> <div class="modal-action"><button class="btn">Cancel</button> <button class="btn btn-primary">Add</button></div></div> <button class="modal-backdrop" aria-label="Close modal"></button></div>'),za=f('<div class="space-y-6"><div class="flex justify-between items-center"><h1 class="text-2xl font-bold">Sources</h1> <button class="btn btn-primary">Add Source</button></div> <!> <!></div> <!>',1);function Va(ea,ta){ga(ta,!0);let g=x(ya([])),A=x(null),B=x(!0),R=x(!1),S=x(""),T=x(""),C=x(""),y=x("");ba(async()=>{await ra()});async function ra(){r(B,!0);try{const[e,t]=await Promise.all([Sa(),wa()]);r(g,e,!0),r(A,t,!0)}catch(e){console.error("Failed to load sources:",e)}r(B,!1)}async function sa(e){try{const t=await Fa(e);r(g,a(g).map(m=>m.id===e?t:m),!0)}catch(t){console.error("Failed to toggle source:",t)}}async function oa(e){if(confirm("Are you sure you want to delete this source?"))try{await Ra(e),r(g,a(g).filter(t=>t.id!==e),!0)}catch(t){console.error("Failed to delete source:",t)}}async function la(){if(r(y,""),!a(S)){r(y,"Please select a source type");return}if(!a(T)){r(y,"Please enter a name");return}if(a(S)==="rss"&&!a(C)){r(y,"RSS sources require a URL");return}try{const e=await ka({type:a(S),name:a(T),url:a(C)||void 0});r(g,[...a(g),e],!0),r(R,!1),K()}catch{r(y,"Failed to create source. You may have reached the RSS limit.")}}function K(){r(S,""),r(T,""),r(C,""),r(y,"")}function ia(){K(),r(R,!0)}var O=za(),Y=X(O),z=o(Y),da=l(o(z),2);da.__click=ia,s(z);var Q=l(z,2);{var na=e=>{var t=Ca(),m=o(t),n=o(m);{var w=u=>{var _=W("Pro Edition - All features unlocked");v(u,_)},h=u=>{var _=W();N(()=>F(_,`Community Edition - RSS feeds limited to ${a(A).max_rss??""}`)),v(u,_)};b(n,u=>{a(A).is_pro?u(w):u(h,!1)})}s(m),s(t),v(e,t)};b(Q,e=>{a(A)&&e(na)})}var ca=l(Q,2);{var va=e=>{var t=Ma();v(e,t)},ua=e=>{var t=Ua();Z(t,21,()=>a(g),$,(m,n)=>{var w=Na(),h=o(w),u=o(h),_=o(u),M=o(_),G=o(M,!0);s(M);var k=l(M,2),U=o(k,!0);s(k);var L=l(k,2);{var H=i=>{var c=Pa();v(i,c)};b(L,i=>{a(n).is_builtin&&i(H)})}s(_);var j=l(_,2);J(j),j.__change=()=>sa(a(n).id),s(u);var P=l(u,2);{var I=i=>{var c=Da(),D=o(c,!0);s(c),N(()=>{ja(c,"title",a(n).url),F(D,a(n).url)}),v(i,c)};b(P,i=>{a(n).url&&i(I)})}var q=l(P,2),d=o(q);{var p=i=>{var c=Ea();c.__click=()=>oa(a(n).id),v(i,c)};b(d,i=>{a(n).is_builtin||i(p)})}s(q),s(h),s(w),N(()=>{F(G,a(n).name),F(U,a(n).type),Aa(j,a(n).enabled)}),v(m,w)}),s(t),v(e,t)};b(ca,e=>{a(B)?e(va):e(ua,!1)})}s(Y);var _a=l(Y,2);{var pa=e=>{var t=Ya(),m=o(t),n=l(o(m),2);{var w=d=>{var p=La(),i=o(p),c=o(i,!0);s(i),s(p),N(()=>F(c,a(y))),v(d,p)};b(n,d=>{a(y)&&d(w)})}var h=l(n,2),u=l(o(h),2),_=o(u);_.value=_.__value="";var M=l(_);{var G=d=>{var p=ma(),i=X(p);Z(i,17,()=>a(A).types,$,(c,D)=>{var E=qa(),fa=o(E,!0);s(E);var V={};N(()=>{F(fa,a(D)),V!==(V=a(D))&&(E.value=(E.__value=a(D))??"")}),v(c,E)}),v(d,p)};b(M,d=>{a(A)&&d(G)})}s(u),s(h);var k=l(h,2),U=l(o(k),2);J(U),s(k);var L=l(k,2);{var H=d=>{var p=Ba(),i=l(o(p),2);J(i),s(p),aa(i,()=>a(C),c=>r(C,c)),v(d,p)};b(L,d=>{a(S)==="rss"&&d(H)})}var j=l(L,2),P=o(j);P.__click=()=>r(R,!1);var I=l(P,2);I.__click=la,s(j),s(m);var q=l(m,2);q.__click=()=>r(R,!1),s(t),Ta(u,()=>a(S),d=>r(S,d)),aa(U,()=>a(T),d=>r(T,d)),v(e,t)};b(_a,e=>{a(R)&&e(pa)})}v(ea,O),ha()}xa(["click","change"]);export{Va as component};
